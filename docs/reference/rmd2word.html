<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Converts R markdown code to Word and PDF documents — rmd2word • accessr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Converts R markdown code to Word and PDF documents — rmd2word"><meta property="og:description" content="Creates Word documents from input R markdown documents. On a Windows
Operating System, accessible PDF documents may be created from these Word
files if the software
OfficeToPDF is installed.
The convenience function install_otp can be used to install
this software. Zip archives of the Word and/or PDF files may be created."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">accessr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/accessr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Converts R markdown code to Word and PDF documents</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/accessr/blob/HEAD/R/rmd2word.R" class="external-link"><code>R/rmd2word.R</code></a></small>
    <div class="hidden name"><code>rmd2word.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates Word documents from input R markdown documents. On a Windows
Operating System, accessible PDF documents may be created from these Word
files if the software
<a href="https://github.com/cognidox/OfficeToPDF" class="external-link">OfficeToPDF</a> is installed.
The convenience function <code><a href="install_otp.html">install_otp</a></code> can be used to install
this software. Zip archives of the Word and/or PDF files may be created.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rmd2word</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  doc <span class="op">=</span> <span class="st">"accessr"</span>,</span>
<span>  pdf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span>,</span>
<span>  <span class="va">dir</span>,</span>
<span>  zip <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">add</span><span class="op">)</span> <span class="cn">FALSE</span> <span class="kw">else</span> <span class="cn">TRUE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rm_word <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rm_pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  inc_word <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A character vector containing the names (<strong>no extension</strong>) of
the <code>.Rmd</code> files to convert  if they are in the current working
directory, or paths to the files, either absolute or relative to the
current working directory, e.g., <code>DIRECTORY/file1</code>.  The <code>.html</code>
files are created in the same directory as their respective <code>.Rmd</code>
file.  If <code>x</code> is missing then an html file is created from each of
the <code>.Rmd</code> files in the current working directory.</p></dd>


<dt>doc</dt>
<dd><p>An optional character vector (<strong>including the file
extension</strong>) to specify template Word documents on which to base the style
of the respective output Word documents. This determines what is passed as
the argument <code>reference_docx</code> to
<code><a href="https://pkgs.rstudio.com/rmarkdown/reference/word_document.html" class="external-link">word_document</a></code>, via
<code><a href="https://davidgohel.github.io/officedown/reference/rdocx_document.html" class="external-link">officedown::rdocx_document</a></code>.
Different templates may be used for different files.
<code>rep_len(doc, length(x))</code> is used to force <code>length(doc)</code> to have
the same length as <code>x</code>. See <strong>Details</strong> for some built-in
options.</p></dd>


<dt>pdf</dt>
<dd><p>A logical scalar.  Should <code>OfficeToPDF.exe</code> be used to
create PDF files from the Word documents that are produced?  If
<code>pdf = FALSE</code> then any zip archives created contain only Word files.
PDF files will only be produced if the Operating System is
<code>"windows"</code>, that is, <code>.Platform$OS.type == "windows"</code>.</p></dd>


<dt>dir</dt>
<dd><p>A path to the directory in which the file <code>OfficeToPDF.exe</code>
sits.  This is not needed if this file sits in the current working
directory or a directory in the list returned by <code><a href="https://rdrr.io/r/base/search.html" class="external-link">searchpaths()</a></code>.
Otherwise, it may be a path relative to the current working directory
or an absolute path.  If <code>dir</code> is missing then <code>rmd2word</code> will
look in <code>system.file(package = "accessr")</code>, which is the default
installation location of <code><a href="install_otp.html">install_otp</a></code>.</p></dd>


<dt>zip</dt>
<dd><p>A logical scalar or character vector indicating whether PDF
files should be put into a zip archive.  If <code>zip = FALSE</code> then no
zip archive is created.  Otherwise, an archive is created in each unique
directory involved in <code>x</code>.  If <code>zip = TRUE</code> then any archive
created has the name <code>accessr_word.zip</code>.  If <code>zip</code> is a
character vector of zip file names (no extension) then these names are
used to name the zip archives.  The names are recycled to the length of
the number of unique directories if necessary.</p></dd>


<dt>add</dt>
<dd><p>A logical scalar that determines what happens if the output
zip file already exists.  If <code>add = TRUE</code> then files are added to the
zip file and if <code>add = FALSE</code> then the zip file is deleted and will
only contain newly-created files.</p></dd>


<dt>quiet</dt>
<dd><p>A logical scalar.  Passed to <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></code> as
the argument <code>quiet</code>.  The default, <code>quite = TRUE</code> suppresses
all printing during rendering of the document.</p></dd>


<dt>rm_word</dt>
<dd><p>A logical scalar.  If <code>rm_word = TRUE</code> then all the Word
files created are deleted.  Otherwise, they are not deleted.</p></dd>


<dt>rm_pdf</dt>
<dd><p>A logical scalar.  If <code>rm_pdf = TRUE</code> and a zip archive
of PDF files is produced then the individual PDF files are deleted.
Otherwise, they are not deleted.</p></dd>


<dt>inc_word</dt>
<dd><p>A logical scalar.  If <code>inc_word = TRUE</code> then the Word
files are included in the zip file created.  Otherwise, they are not
included.</p></dd>


<dt>params</dt>
<dd><p>A list of named parameters to pass as the argument
<code>params</code> to <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to
<code><a href="https://pkgs.rstudio.com/rmarkdown/reference/word_document.html" class="external-link">word_document</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>In addition to creating the Word and PDF files, and perhaps zip
files, a list containing the following vector components is returned
invisibly:</p>
<dl><dt>error_codes </dt>
<dd><p>If <code>pdf = TRUE</code>, numeric values returned from
<code><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></code>.
If <code>wait = FALSE</code> then these values will be 0 (the success value)
even if some of the PDF files could not be produced.  The error code 17234
indicates that a PDF file was open in another application.</p></dd>

<dt>files </dt>
<dd><p>(absolute) paths and file names of all files created.</p></dd>

<dt>zips </dt>
<dd><p>(relative) paths and names of all zip files created (if
<code>zip = TRUE</code>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Information such as <code>title</code>, <code>author</code>, <code>lang</code> etc in
the YAML header in the Rmd file are used but <code>output</code> is ignored.</p>
<p>The simplest setup is to have the <code>.Rmd</code> files and the Word
template (if used) and <code>OfficeToPDF.exe</code> in the current working
directory.</p>
<p>It is possible to have the <code>.Rmd</code> files in different
directories, but any non-<code>"default"</code> values in <code>doc</code> must be
such that the <code>reference_docx</code> argument of
<code><a href="https://pkgs.rstudio.com/rmarkdown/reference/word_document.html" class="external-link">word_document</a></code> finds a template Word file.
If the template is in the same directory as its respective <code>.Rmd</code>
component in  <code>x</code> then the filename, e.g. <code>"template.docx"</code> will
suffice.  Otherwise, a path to the template should be given, either
relative to the directory in which the <code>.Rmd</code> file sits, or an
absolute path.</p>
<p>For information on how to create a template Word document see Richard
Layton's guide
<a href="https://rmarkdown.rstudio.com/articles_docx.html" class="external-link">Happy collaboration
with Rmd to docx</a>.</p>
<p>There are some built-in template options:</p><ul><li><p><code>doc = "officedown"</code>: uses
<code><a href="https://davidgohel.github.io/officedown/reference/rdocx_document.html" class="external-link">rdocx_document</a></code>'s default,</p></li>
<li><p><code>doc = "accessr"</code>: similar to <code>"officedown"</code> but with
narrower margins and black text for titles and darker hyperlinks, to
avoid contrast issues,</p></li>
<li><p><code>doc = "18"</code>: like <code>"accessr"</code> but with 18pt text,</p></li>
<li><p><code>doc = "exam"</code>: creates a Word file with a header
"Examination paper for STAT0002" on the left and "Page x of n" on the
right.</p></li>
</ul><p>To use your own template(s), provide their filename(s).
A component equal to <code>"officedown"</code> chooses
<code><a href="https://davidgohel.github.io/officedown/reference/rdocx_document.html" class="external-link">rdocx_document</a></code>'s default.
A component equal to <code>"accessr"</code> chooses <code>accessr</code>'s internal
template file, which has narrower margins and darker blue fonts for titles
and hyperlinks, to avoid contrast issues.  To use your own template(s),
provide their filenames.  See <strong>Details</strong> for more information.</p>
<p>The <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></code> function creates a Word file from
each input <code>.Rmd</code> file.  Then
<a href="https://github.com/cognidox/OfficeToPDF" class="external-link">OfficeToPDF</a> is used to
convert the Word file to a PDF file.  The file <code>OfficeToPDF.exe</code>
needs to be downloaded from the
<a href="https://github.com/cognidox/OfficeToPDF/releases" class="external-link">OfficeToPDF
releases</a> page and placed in the directory specified by the argument
<code>dir</code>, or in a directory that is in the list returned by
<code><a href="https://rdrr.io/r/base/search.html" class="external-link">searchpaths</a></code>.
If <code>OfficeToPDF.exe</code> cannot be found then an error is thrown.
A warning will be given if any of the PDF files could not be produced.
This will occur if there is an existing PDF file of the same name open
in another application.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Layton, Richard. (2015) Happy collaboration with Rmd to docx.
R Markdown from RStudio article.
<a href="https://rmarkdown.rstudio.com/articles_docx.html" class="external-link">https://rmarkdown.rstudio.com/articles_docx.html</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="install_otp.html">install_otp</a></code> to install
<a href="https://github.com/cognidox/OfficeToPDF" class="external-link">OfficeToPDF</a>.</p>
<p><code><a href="rmd2ioslides.html">rmd2ioslides</a></code>, <code><a href="rmd2slidy.html">rmd2slidy</a></code>,
<code><a href="rmd2html.html">rmd2html</a></code> for other output formats.</p>
<p>The <a href="https://paulnorthrop.github.io/accessr/" class="external-link">accessr
package page on Github</a>. In particular, the README file suggests copying
to your working directory the example file <code>example.Rmd</code> used below.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a Word file from example.Rmd</span></span></span>
<span class="r-in"><span><span class="va">got_hux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"huxtable"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">got_flex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"flextable"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">got_pandoc</span> <span class="op">&lt;-</span> <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/pandoc_available.html" class="external-link">pandoc_available</a></span><span class="op">(</span><span class="st">"1.14"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">got_all</span> <span class="op">&lt;-</span> <span class="va">got_hux</span> <span class="op">&amp;&amp;</span> <span class="va">got_flex</span> <span class="op">&amp;&amp;</span> <span class="va">got_pandoc</span></span></span>
<span class="r-in"><span><span class="co"># This example needs packages huxtable and flextable</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">got_all</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"accessr"</span>, <span class="st">"examples"</span>, <span class="st">"example.Rmd"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".Rmd"</span>, <span class="st">""</span>, <span class="va">ex_file</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">rmd2word</span><span class="op">(</span><span class="va">ex_file</span>, pdf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Install OfficeToPDF to create PDF files</span></span></span>
<span class="r-in"><span><span class="fu"><a href="install_otp.html">install_otp</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create PDF documents files from your files file1.Rmd and file2.Rmd</span></span></span>
<span class="r-in"><span><span class="fu">rmd2pdf</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"file1"</span>, <span class="st">"file2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create Word and PDF files from all Rmd files in your working directory</span></span></span>
<span class="r-in"><span><span class="fu">rmd2word</span><span class="op">(</span>inc_word <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

